definition {
	var assetType = "Message Boards Thread";
	var userName = "Test Test";

	macro addCP {
		LexiconEntry.gotoAddMenuItem(menuItem = "Thread");

		AssertElementPresent(locator1 = "TextInput#SUBJECT");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditor(locator1 = "CKEditor#BODY_FIELD", value1 = "${threadBody}");

		PortletEntry.publish();
	}

	macro addCPWithAttachment {
		LexiconEntry.gotoAddMenuItem(menuItem = "Thread");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditor(locator1 = "CKEditor#BODY_FIELD", value1 = "${threadBody}");

		Panel.expandPanel(panelHeading = "Attachments");

		UploadCommonFile(
			locator1 = "MessageBoardsEditMessage#ATTACHMENTS_BROWSE_FIELD",
			value1 = "${mbAttachmentFile}"
		);

		PortletEntry.publish();
	}

	macro addInvalidAttachmentPG {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		Pause(locator1 = "3000");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Panel.expandPanel(panelHeading = "Attachments");

		UploadCommonFile(
			locator1 = "MessageBoardsEditMessage#ATTACHMENTS_BROWSE_FIELD",
			value1 = "${mbThreadAttachment}"
		);

		AssertClick(locator1 = "Button#PUBLISH", value1 = "Publish");

		Alert.viewRequestFailedToComplete();

		if ("${invalidSize}" == "true") {
			AssertTextEquals.assertPartialText(
				locator1 = "Message#ERROR_2",
				value1 = "Request is larger than ${maxAttachmentFileSize}KB and could not be processed."
			);
		}
	}

	macro addPG {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		AssertElementPresent(locator1 = "TextInput#SUBJECT");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		if (isSet(source)) {
			Click(locator1 = "CKEditor#TOOLBAR_SOURCE_BUTTON");

			Type(locator1 = "CKEditor#BODY_FIELD_SOURCE_ON", value1 = "${threadBody}");

			Click(locator1 = "CKEditor#TOOLBAR_SOURCE_BUTTON");

			if (isSet(fontSize)) {
				AssertClick(locator1 = "CKEditor#TOOLBAR_SIZE_BUTTON", value1 = "Size");

				AssertTextEquals(
					locator1 = "CKEditor#TOOLBAR_SIZE_BUTTON_DROPDOWN",
					value1 = "${fontSize}",
					key_fontSize = "${fontSize}"
				);
			}
		}
		else {
			Type.typeCKEditorWaitForCKEditor(
				locator1 = "CKEditor#BODY_FIELD",
				value1 = "${threadBody}"
			);
		}

		PortletEntry.publish();
	}

	macro addPGAsQuestion {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadBody}"
		);

		Panel.expandPanel(panelHeading = "More Settings");

		Check(locator1 = "Checkbox#MARK_AS_A_QUESTION");

		PortletEntry.publish();

		Click(locator1 = "Icon#ANGLE_LEFT_BACK");

		MessageboardsThread.viewMarkedAsQuestionPG(threadSubject = "${threadSubject}");
	}

	macro addPGWithAttachment {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadBody}"
		);

		Panel.expandPanel(panelHeading = "Attachments");

		UploadCommonFile(
			locator1 = "MessageBoardsEditMessage#ATTACHMENTS_BROWSE_FIELD",
			value1 = "${mbThreadAttachment}"
		);

		Button.clickPublish();

		AssertElementPresent(
			locator1 = "MessageBoardsThread#THREAD_REPLY_BUTTON",
			key_threadSubject = "${threadSubject}"
		);

		Alert.viewSuccessMessage();
	}

	macro addPGWithPermissions {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadBody}"
		);

		Panel.expandPanel(panelHeading = "Permissions");

		Select(
			locator1 = "AssetPermissions#VIEWABLE_AS_SELECT",
			value1 = "${viewableBySelection}"
		);

		PortletEntry.publish();
	}

	macro addWithWorkflowCP {
		LexiconEntry.gotoAddMenuItem(menuItem = "Thread");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditor(locator1 = "CKEditor#BODY_FIELD", value1 = "${threadBody}");

		Click(locator1 = "Button#SUBMIT_FOR_PUBLICATION");

		Alert.viewSuccessMessage();
	}

	macro addWithWorkflowPG {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadBody}"
		);

		Click(locator1 = "Button#SUBMIT_FOR_PUBLICATION");

		Alert.viewSuccessMessage();
	}

	macro banUser {
		AssertClick(
			locator1 = "MessageBoardsThread#MESSAGE_BAN_THIS_USER",
			value1 = "Ban This User",
			key_userName = "${userName}"
		);

		Alert.viewSuccessMessage();
	}

	macro cancelAdd {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadBody}"
		);

		AssertClick(locator1 = "Button#CANCEL", value1 = "Cancel");
	}

	macro cancelEdit {
		LexiconEntry.gotoEllipsisMenuItem(menuItem = "Edit");

		Click(locator1 = "TextInput#SUBJECT");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubjectEdit}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadBodyEdit}"
		);

		AssertClick(locator1 = "Button#CANCEL", value1 = "Cancel");
	}

	macro deletePG {
		var key_threadSubject = "${threadSubject}";

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		Click(locator1 = "MessageBoards#VERTICAL_ELLIPSIS");

		Click(
			locator1 = "MenuItem#ANY_MENU_ITEM",
			key_menuItem = "Move to the Recycle Bin"
		);

		AssertElementPresent(locator1 = "Message#SUCCESS");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_THREAD");
	}

	macro downloadAttachmentPG {
		Click(locator1 = "MessageBoardsThread#MESSAGE_BODY_ATTACHMENT_1");

		DownloadTempFile();
	}

	macro editCP {
		LexiconEntry.gotoEllipsisMenuItem(menuItem = "Edit");

		if ("${threadAttachmentRemove}" == "true") {
			Panel.expandPanel(panelHeading = "Attachments");

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsEditMessage#ATTACHMENTS_NAME",
				value1 = "${mbAttachmentFile}"
			);

			AssertClick(
				locator1 = "MessageBoardsEditMessage#ATTACHMENTS_REMOVE_LINK",
				value1 = "Remove"
			);
		}

		if (isSet(threadSubjectEdit)) {
			Click(locator1 = "TextInput#SUBJECT");

			Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubjectEdit}");
		}

		if (isSet(threadBodyEdit)) {
			Type.typeCKEditorWaitForCKEditor(
				locator1 = "CKEditor#BODY_FIELD",
				value1 = "${threadBodyEdit}"
			);
		}

		PortletEntry.publish();
	}

	macro editPG {
		LexiconEntry.gotoEllipsisMenuItem(menuItem = "Edit");

		if (isSet(threadSubjectEdit)) {
			Click(locator1 = "TextInput#SUBJECT");

			Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubjectEdit}");
		}

		if (isSet(threadBodyEdit)) {
			Type.typeCKEditorWaitForCKEditor(
				locator1 = "CKEditor#BODY_FIELD",
				value1 = "${threadBodyEdit}"
			);
		}

		if ("${saveAsDraft}" == "true") {
			AssertClick(locator1 = "Button#SAVE_AS_DRAFT", value1 = "Save as Draft");
		}
		else if ("${preview}" == "true") {
			AssertClickNoError(locator1 = "Button#PREVIEW", value1 = "Preview");

			Confirm(
				value1 = "In order to preview your changes, the message will be saved as a draft and other users may not be able to see it. Are you sure you want to do this?"
			);

			var key_threadSubject = "${threadSubject}";
			var key_userName = "${userName}";

			AssertTextEquals(
				locator1 = "Portlet#H3_HEADER_TITLE",
				value1 = "Edit ${threadSubject}"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#THREAD_USERNAME",
				value1 = "${userName}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#THREAD_USERNAME",
				value1 = "${threadSubject}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#MESSAGE_WORKFLOW_STATUS_1",
				value1 = "Draft"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#MESSAGE_BODY_1",
				value1 = "${threadBodyEdit}"
			);
		}
		else {
			AssertClick(locator1 = "Button#PUBLISH", value1 = "Publish");
		}

		Alert.viewSuccessMessage();
	}

	macro editViaMyPosts {
		AssertClick(locator1 = "MessageBoards#NAVIGATION_MY_POSTS", value1 = "My Posts");

		var key_threadSubject = "${threadSubject}";

		if ("threadSubjectEdit" == "true") {
			var key_threadSubject = "${threadSubjectEdit}";
		}

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		Click(locator1 = "MessageBoards#VERTICAL_ELLIPSIS");

		AssertClick(
			locator1 = "MenuItem#ANY_MENU_ITEM",
			value1 = "Edit",
			key_menuItem = "Edit"
		);

		PortletEntry.publish();
	}

	macro gotoCP {
		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}",
			key_threadSubject = "${threadSubject}"
		);
	}

	macro gotoPG {
		var key_postsNumber = "${postCount}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${lastPostUserName}";

		if (isSet(messageBoardsThreadURL)) {
			AssertLocation(value1 = "${messageBoardsThreadURL}");
		}
		else {
			AssertTextEquals(
				locator1 = "MessageBoards#THREAD_LIST_THREAD",
				value1 = "${threadSubject}"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoards#THREAD_LIST_POSTS",
				value1 = "${postCount} Post"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoards#THREAD_LIST_LAST_POST",
				value1 = "${lastPostUserName}"
			);

			AssertClick(
				locator1 = "MessageBoards#THREAD_LIST_THREAD",
				value1 = "${threadSubject}"
			);
		}
	}

	macro gotoViewInContext {
		AssertClick(locator1 = "Link#VIEW_IN_CONTEXT", value1 = "View in Context Â»");
	}

	macro markAsAnswerCP {
		Click(
			locator1 = "MessageBoards#THREAD_REPLY_ACTIONS",
			key_threadReplyBody = "${threadReplyBody}"
		);

		AssertClick(
			locator1 = "MenuItem#ANY_MENU_ITEM",
			value1 = "Mark as an Answer",
			key_menuItem = "Mark as an Answer"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#MESSAGE_ANSWER_1",
			value1 = "Answer"
		);
	}

	macro markAsAnswerPG {
		Click(
			locator1 = "MessageBoards#THREAD_REPLY_ACTIONS",
			key_threadReplyBody = "${threadReplyBody}"
		);

		AssertClick(
			locator1 = "MenuItem#ANY_MENU_ITEM",
			value1 = "Mark as an Answer",
			key_menuItem = "Mark as an Answer"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#MESSAGE_ANSWER_1",
			value1 = "Answer"
		);
	}

	macro movePG {
		AssertClick(
			locator1 = "MessageBoards#CATEGORY_LIST_CATEGORY",
			value1 = "${categoryName1}",
			key_categoryName = "${categoryName1}"
		);

		Click(
			locator1 = "MessageBoards#VERTICAL_ELLIPSIS",
			key_threadSubject = "${threadSubject}"
		);

		AssertClick(
			locator1 = "MenuItem#ANY_MENU_ITEM",
			value1 = "Move",
			key_menuItem = "Move"
		);

		AssertClick(locator1 = "Button#SELECT", value1 = "Select");

		Pause(locator1 = "5000");

		SelectFrame(locator1 = "MessageBoardsSelectCategory#IFRAME");

		AssertClick(
			locator1 = "MessageBoardsSelectCategory#CATEGORY_TABLE_CHOOSE_BUTTON_2",
			value1 = "Choose"
		);

		if ("${explanationPost}" == "true") {
			SelectFrame(value1 = "relative=top");

			AssertElementPresent(locator1 = "MessageBoardsMoveThread#CATEGORY_FIELD");

			Check(locator1 = "Checkbox#ADD_EXPLANATION_POST");

			Type(locator1 = "TextInput#SUBJECT", value1 = "${explanationSubject}");

			Type.typeCKEditorWaitForCKEditor(
				locator1 = "CKEditor#BODY_FIELD",
				value1 = "${explanationBody}"
			);
		}

		SelectFrame(value1 = "relative=top");

		AssertElementPresent(locator1 = "MessageBoardsMoveThread#CATEGORY_FIELD");

		AssertClick(locator1 = "Button#MOVE_THREAD", value1 = "Move Thread");

		Alert.viewSuccessMessage();
	}

	macro moveToRecycleBinCP {
		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}",
			key_threadSubject = "${threadSubject}"
		);

		LexiconEntry.gotoEllipsisMenuItem(menuItem = "Move to the Recycle Bin");

		AssertElementPresent(locator1 = "Message#SUCCESS");

		AssertTextEquals.assertText(
			locator1 = "Message#EMPTY_INFO",
			value1 = "There are no threads nor categories."
		);
	}

	macro quickReplyPG {
		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}",
			key_threadSubject = "${threadSubject}"
		);

		LexiconEntry.gotoEllipsisMenuItem(menuItem = "Quick Reply");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadReplyBody}"
		);

		PortletEntry.publish();
	}

	macro replyCP {
		if ("${markAsQuestion}" == "true") {
			AssertClick(
				locator1 = "MessageBoards#THREAD_TABLE_STARTED_BY",
				value1 = "Waiting for an Answer",
				key_threadSubject = "${threadSubject}"
			);
		}

		Click(
			locator1 = "MessageBoardsThread#THREAD_REPLY_BUTTON",
			key_threadSubject = "${threadSubject}"
		);

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadReplyBody}"
		);

		PortletEntry.publish();

		if ("${markAsAnswer}" == "true") {
			MessageboardsThread.markAsAnswerCP(threadReplyBody = "${threadReplyBody}");
		}
	}

	macro replyPG {
		if ("${displayStyle}" == "Question") {
			AssertClick(
				locator1 = "MessageBoards#QUESTION_CATEGORY_THREAD_TABLE_QUESTION",
				value1 = "${threadSubject}",
				key_threadSubject = "${threadSubject}"
			);
		}
		else {
			var key_threadSubject = "${threadSubject}";

			AssertTextEquals(
				locator1 = "MessageBoards#THREAD_LIST_THREAD",
				value1 = "${threadSubject}"
			);

			Click(locator1 = "MessageBoards#THREAD_LIST_THREAD");
		}

		if (isSet(threadReplySpecific)) {
			AssertClick(
				locator1 = "MessageBoardsThread#MESSAGE_REPLY_SPECIFIC",
				value1 = "Reply",
				key_threadBody = "${threadBody}"
			);
		}
		else {
			AssertElementPresent(
				locator1 = "MessageBoardsThread#THREAD_REPLY_BUTTON",
				key_threadSubject = "${threadSubject}"
			);

			AssertClick(
				locator1 = "MessageBoardsThread#THREAD_REPLY_BUTTON",
				value1 = "Reply to Main Thread",
				key_threadSubject = "${threadSubject}"
			);
		}

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadReplyBody}"
		);

		if ("${anonymous}" == "true") {
			Check(locator1 = "Checkbox#ANONYMOUS");
		}

		if (isSet(mbThreadAttachment)) {
			if (IsNotVisible(locator1 = "MessageBoardsEditMessage#ATTACHMENTS_BROWSE_FIELD")) {
				AssertClick(locator1 = "Panel#ENTRY_ATTACHMENTS", value1 = "Attachments");
			}

			UploadCommonFile(
				locator1 = "MessageBoardsEditMessage#ATTACHMENTS_BROWSE_FIELD",
				value1 = "${mbThreadAttachment}"
			);
		}

		Click(locator1 = "Button#PUBLISH");

		Alert.viewSuccessMessage();

		if ("${markAsAnswer}" == "true") {
			MessageboardsThread.markAsAnswerPG(threadReplyBody = "${threadReplyBody}");
		}
	}

	macro restoreMBAttachmentCP {
		Click(locator1 = "MessageBoardsThread#MESSAGE_BODY_ATTACHMENT_1");

		AssertTextEquals(
			locator1 = "MessageBoardsRemovedAttachments#ATTACHMENT_TABLE_NAME",
			value1 = "${mbAttachmentFile}",
			key_mbAttachmentFile = "${mbAttachmentFile}"
		);

		LexiconEntry.gotoEllipsisMenuItem(menuItem = "Restore");

		Alert.viewSuccessMessage();

		AssertTextEquals(
			locator1 = "Message#INFO",
			value1 = "This message does not have file attachments in the Recycle Bin."
		);
	}

	macro saveNewThreadAsDraft {
		AssertClick(locator1 = "Button#POST_NEW_THREAD", value1 = "Post New Thread");

		AssertElementPresent(locator1 = "CKEditor#BODY_FIELD");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadBody}"
		);

		AssertClick(locator1 = "Button#SAVE_AS_DRAFT", value1 = "Save as Draft");

		AssertTextEquals.assertPartialText(
			locator1 = "Portlet#HEADER_TITLE",
			value1 = "Edit"
		);

		Alert.viewSuccessMessage();
	}

	macro splitThreadPG {
		Click(locator1 = "Icon#BODY_VERTICAL_ELLIPSIS_2");

		AssertClick(
			locator1 = "MenuItem#ANY_MENU_ITEM",
			value1 = "Split Thread",
			key_menuItem = "Split Thread"
		);

		AssertTextEquals(
			locator1 = "Message#INFO",
			value1 = "Click OK to create a new thread with the following messages."
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsSplitThread#THREAD_TABLE_SUBJECT",
			value1 = "${threadSubject}",
			key_threadSubject = "${threadSubject}"
		);

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSplitSubject}");

		AssertTextEquals(
			locator1 = "MessageBoardsSplitThread#ADD_EXPLANATION_POST_LABEL",
			value1 = "Add explanation post to the source thread."
		);

		Check(locator1 = "MessageBoardsSplitThread#ADD_EXPLANATION_POST_CHECKBOX");

		AssertTextEquals(
			locator1 = "Message#INFO_EXPLANATION_POST",
			value1 = "The following post will be added in place of the moved message."
		);

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSplitReplySubject}");

		Type.typeCKEditorWaitForCKEditor(
			locator1 = "CKEditor#BODY_FIELD",
			value1 = "${threadSplitReplyBody}"
		);

		AssertClick(locator1 = "Button#OK", value1 = "OK");

		var key_threadBody = "${threadReplyBody}";

		AssertTextEquals(
			locator1 = "Portlet#H3_HEADER_TITLE",
			value1 = "${threadSplitReplySubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadReplyBody}"
		);

		AssertElementNotPresent(locator1 = "MessageBoardsThread#THREAD_BODY_2");
	}

	macro tearDownCP {
		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Message Boards"
		);

		if (IsElementPresent.isVisible(locator1 = "MessageBoards#THREAD_TABLE_ALL_CHECKBOX")) {
			Check(locator1 = "MessageBoards#THREAD_TABLE_ALL_CHECKBOX");

			AssertClick(
				locator1 = "MessageBoardsAdmin#THREADS_RECYCLE_BIN_BUTTON",
				value1 = "Move to the Recycle Bin"
			);

			AssertElementPresent(locator1 = "Message#SUCCESS");
		}

		Navigator.openURL();

		ProductMenu.gotoPortlet(
			category = "Content",
			panel = "Site Administration",
			portlet = "Recycle Bin"
		);

		RecycleBin.emptyCP();
	}

	macro viewAnonymousPostingCheckboxCP {
		LexiconEntry.gotoAddMenuItem(menuItem = "Thread");

		AssertElementPresent(locator1 = "Checkbox#ANONYMOUS");
	}

	macro viewAnswerPG {
		var key_threadSubject = "${threadSubject}";

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_ANSWER",
			value1 = "Answer"
		);

		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#MESSAGE_ANSWER_1",
			value1 = "Answer"
		);

		AssertClick.assertPartialTextClickAt(locator1 = "Link#BACK", value1 = "Back");
	}

	macro viewAsWorkflowAsset {
		SiteAdmin.viewPortletTitle(portletTitle = "${threadSubject}");

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}",
			key_threadBody = "${threadBody}"
		);
	}

	macro viewBBCodeNoXSS {
		var key_threadBody = "${threadBody}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertAlertNotPresent();

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_LAST_POST",
			value1 = "${userName}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_REPLY_SUBJECT",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}"
		);
	}

	macro viewCP {
		var key_threadBody = "${threadBody}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_LAST_POST",
			value1 = "${userName}"
		);

		var key_postsNumber = "${postsNumber}";

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_POSTS",
			value1 = "${postsNumber}"
		);

		AssertElementPresent(locator1 = "MessageBoards#THREAD_LIST_VIEWS");

		AssertElementPresent(locator1 = "MessageBoards#VERTICAL_ELLIPSIS");

		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(locator1 = "Portlet#HEADER", value1 = "${threadSubject}");

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_USERNAME",
			value1 = "${userName}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}"
		);

		if (isSet(mbAttachmentFile)) {
			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#MESSAGE_BODY_ATTACHMENT_1",
				value1 = "${mbAttachmentFile}"
			);
		}
	}

	macro viewDefaultCP {
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertTextEquals.assertText(
			locator1 = "Message#EMPTY_INFO",
			value1 = "There are no threads nor categories."
		);

		AssertTextNotPresent(value1 = "${threadSubject}");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_CHECKBOX");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_THREAD");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_LAST_POST");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_POSTS");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_VIEWS");

		AssertElementNotPresent(locator1 = "MessageBoards#VERTICAL_ELLIPSIS");
	}

	macro viewDoNotHaveRequiredPermissionsPG {
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		Alert.viewRequestFailedToComplete();

		AssertTextEquals.assertPartialText(
			locator1 = "Message#ERROR_2",
			value1 = "You do not have the required permissions."
		);

		AssertTextNotPresent(value1 = "${threadSubject}");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_THREAD");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_TABLE_STARTED_BY");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_TABLE_POSTS");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_LAST_POST");
	}

	macro viewLockedPG {
		var key_threadStatus = "Locked";
		var key_threadSubject = "${threadSubject}";

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_STATUS",
			value1 = "Locked"
		);

		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_ACTIONS_UNLOCK_THREAD",
			value1 = "Unlock Thread"
		);

		AssertElementNotPresent(locator1 = "MessageBoardsThread#MESSAGE_REPLY_1");

		AssertElementNotPresent(locator1 = "MessageBoardsThread#MESSAGE_QUICK_REPLY_1");

		AssertElementNotPresent(
			locator1 = "MessageBoardsThread#MESSAGE_REPLY_WITH_QUOTE_1"
		);

		AssertElementNotPresent(locator1 = "MessageBoardsThread#MESSAGE_EDIT_1");
	}

	macro viewMarkAsQuestionCheckedCP {
		LexiconEntry.gotoAddMenuItem(menuItem = "Thread");

		AssertVisible(locator1 = "Button#PUBLISH");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Panel.expandPanel(panelHeading = "More Settings");

		AssertChecked(locator1 = "Checkbox#MARK_AS_A_QUESTION");

		AssertClick(locator1 = "Button#CANCEL", value1 = "Cancel");
	}

	macro viewMarkAsQuestionNotCheckedCP {
		LexiconEntry.gotoAddMenuItem(menuItem = "Thread");

		AssertVisible(locator1 = "Button#PUBLISH");

		Type(locator1 = "TextInput#SUBJECT", value1 = "${threadSubject}");

		Panel.expandPanel(panelHeading = "More Settings");

		AssertNotChecked(locator1 = "Checkbox#MARK_AS_A_QUESTION");

		AssertClick(locator1 = "Button#CANCEL", value1 = "Cancel");
	}

	macro viewMarkedAsQuestionPG {
		AssertElementPresent(
			locator1 = "MessageBoards#THREAD_LIST_QUESTION_MARK_ICON",
			key_threadSubject = "${threadSubject}"
		);
	}

	macro viewNoAnonymousPostingCheckboxCP {
		LexiconEntry.gotoAddMenuItem(menuItem = "Thread");

		AssertElementNotPresent(locator1 = "Checkbox#ANONYMOUS");
	}

	macro viewNoPG {
		var key_threadSubject = "${threadSubject}";

		AssertTextEquals.assertText(
			locator1 = "Message#EMPTY_INFO",
			value1 = "There are no threads nor categories."
		);

		AssertTextNotPresent(value1 = "${threadSubject}");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_THREAD");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_TABLE_STARTED_BY");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_TABLE_POSTS");

		AssertElementNotPresent(locator1 = "MessageBoards#THREAD_LIST_LAST_POST");
	}

	macro viewNoXSSPG {
		var key_threadBody = "";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertAlertNotPresent();

		AssertTextEquals(
			locator1 = "Portlet#H3_HEADER_TITLE",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_USERNAME",
			value1 = "${userName}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(locator1 = "MessageBoardsThread#THREAD_BODY", value1 = "");
	}

	macro viewPG {
		var key_threadBody = "${threadBody}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertTextEquals(
			locator1 = "Portlet#H3_HEADER_TITLE",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_USERNAME",
			value1 = "${userName}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}"
		);

		if (isSet(fontSize)) {
			AssertTextEquals(
				locator1 = "MessageBoardsThread#MESSAGE_BODY_STYLE_1",
				value1 = "${threadBody}",
				key_fontSize = "${fontSize}"
			);
		}

		if (isSet(threadSubject2)) {
			var key_threadSubject = "${threadSubject2}";

			AssertTextEquals(
				locator1 = "Portlet#H3_HEADER_TITLE",
				value1 = "${threadSubject}"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#THREAD_USERNAME",
				value1 = "${userName}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#THREAD_SUBJECT",
				value1 = "${threadSubject2}"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#THREAD_BODY",
				value1 = "${threadBody2}",
				key_threadBody = "${threadBody2}"
			);
		}

		if (isSet(workflowTask)) {
			AssertTextEquals(
				locator1 = "MessageBoardsThread#MESSAGE_WORKFLOW_STATUS_1",
				value1 = "Pending (${workflowTask})"
			);
		}
	}

	macro viewPGViaAP {
		var key_assetTitle = "${threadSubject}";

		AssertTextEquals(
			locator1 = "AP#ASSET_ABSTRACT_TITLE",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "AP#ASSET_ABSTRACT_DESCRIPTION",
			value1 = "${threadBody}"
		);

		AssertClick(locator1 = "AP#ASSET_ABSTRACT_TITLE", value1 = "${threadSubject}");

		AssertVisible(locator1 = "Icon#SHARE");

		AssertTextEquals(
			locator1 = "APAsset#ASSET_TITLE_HEADER",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "AssetRelatedAssets#MESSAGE_BOARDS_THREAD_TITLE",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "AssetRelatedAssets#MESSAGE_BOARDS_THREAD_CONTENT",
			value1 = "${threadBody}"
		);
	}

	macro viewReplyCP {
		var key_threadBody = "${threadBody}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		if (isSet(mbAttachmentFile)) {
			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#MESSAGE_BODY_ATTACHMENT_1",
				value1 = "${mbAttachmentFile}"
			);
		}

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_USERNAME_2",
			value1 = "${userName}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}"
		);
	}

	macro viewReplyPG {
		var key_postsNumber = "${postCount}";
		var key_threadBody = "${threadBody}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_LAST_POST",
			value1 = "${userName}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_POSTS",
			value1 = "${postCount} Post"
		);

		if ("${guestReply}" == "true") {
			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoards#THREAD_LIST_LAST_POST",
				value1 = "Anonymous"
			);

			AssertClick(
				locator1 = "MessageBoards#THREAD_LIST_THREAD",
				value1 = "${threadSubject}"
			);
		}
		else {
			AssertClick(
				locator1 = "MessageBoards#THREAD_LIST_THREAD",
				value1 = "${threadSubject}"
			);
		}

		if ("${loggedOut}" == "true") {
			var key_threadBody = "${threadReplyBody}";

			AssertTextEquals(
				locator1 = "MessageBoardsThread#THREAD_SUBJECT_2",
				value1 = "RE: ${threadSubject}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#THREAD_BODY",
				value1 = "${threadReplyBody}"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#THREAD_USERNAME",
				value1 = "${userName}"
			);
		}
		else {
			AssertTextEquals(
				locator1 = "MessageBoardsThread#THREAD_SUBJECT",
				value1 = "${threadSubject}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#THREAD_BODY",
				value1 = "${threadBody}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#THREAD_SUBJECT_2",
				value1 = "RE: ${threadSubject}"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#THREAD_USERNAME",
				value1 = "${userName}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#MESSAGE_RATING_1_UPVOTE",
				value1 = "0"
			);

			var key_threadBody = "${threadReplyBody}";

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#THREAD_BODY",
				value1 = "${threadReplyBody}"
			);

			AssertTextEquals.assertPartialText(
				locator1 = "MessageBoardsThread#THREAD_USERNAME",
				value1 = "${userName}"
			);

			AssertTextEquals(
				locator1 = "MessageBoardsThread#MESSAGE_RATING_2_UPVOTE",
				value1 = "0"
			);
		}

		if ("${guestReply}" == "false") {
			AssertTextEquals(
				locator1 = "MessageBoardsThread#MESSAGE_USERNAME_2",
				value1 = "${userName}"
			);
		}

		if (isSet(mbThreadAttachment)) {
			AssertElementPresent(
				locator1 = "MessageBoardsThread#MESSAGE_ATTACHMENT_IMAGE",
				key_mbThreadAttachment = "${mbThreadAttachment}"
			);
		}
	}

	macro viewReplyWithUpvote {
		var key_postsNumber = "${postCount}";
		var key_threadBody = "${threadBody}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_POSTS",
			value1 = "${postCount} Posts"
		);

		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_USERNAME",
			value1 = "${userName}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#MESSAGE_RATING_1_UPVOTE",
			value1 = "0"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}"
		);

		if (isSet(threadReplyBodyList)) {
			for (var threadReplyBody : list "${threadReplyBodyList}") {
				var key_threadBody = "${threadReplyBody}";

				AssertTextEquals(
					locator1 = "MessageBoardsThread#THREAD_REPLY_SUBJECT",
					value1 = "RE: ${threadSubject}"
				);

				AssertTextEquals.assertPartialText(
					locator1 = "MessageBoardsThread#THREAD_BODY",
					value1 = "${threadReplyBody}"
				);
			}
		}
	}

	macro viewSplitThreadPG {
		var key_threadBody = "${threadBody}";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_TABLE_POSTS",
			value1 = "2 Posts"
		);

		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "Portlet#H3_HEADER_TITLE",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}"
		);

		var key_threadBody = "${threadSplitReplyBody}";
		var key_threadSubject = "Thread Split";

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "Thread Split"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadSplitReplyBody}"
		);

		Navigator.gotoPage(pageName = "${pageName}");

		var key_postsNumber = "1";
		var key_threadBody = "${threadReplyBody}";
		var key_threadSubject = "${threadSplitReplySubject}";

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSplitReplySubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoards#THREAD_LIST_POSTS",
			value1 = "1"
		);

		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSplitReplySubject}"
		);

		AssertTextEquals(
			locator1 = "Portlet#H3_HEADER_TITLE",
			value1 = "${threadSplitReplySubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "${threadSplitReplySubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadReplyBody}"
		);

		AssertElementNotPresent(locator1 = "MessageBoardsThread#THREAD_SUBJECT_2");

		AssertElementNotPresent(locator1 = "MessageBoardsThread#THREAD_BODY_2");
	}

	macro viewStatisticsPostsCountDefaultPG {
		AssertClick(
			locator1 = "MessageBoards#NAVIGATION_STATISTICS",
			value1 = "Statistics"
		);

		if (IsElementPresent(locator1 = "MessageBoardsStatistics#GENERAL_DROPDOWN_COLLAPSED")) {
			AssertClick(
				locator1 = "MessageBoardsStatistics#GENERAL_DROPDOWN",
				value1 = "General"
			);
		}

		AssertTextEquals(
			locator1 = "MessageBoardsStatistics#GENERAL_NUMBER_OF_CATEGORIES",
			value1 = "0"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsStatistics#GENERAL_NUMBER_OF_POSTS",
			value1 = "0"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsStatistics#GENERAL_NUMBER_OF_PARTICIPANTS",
			value1 = "0"
		);

		AssertTextEquals(
			locator1 = "Message#EMPTY_INFO",
			value1 = "There are no top posters."
		);
	}

	macro viewStatisticsPostsCountPG {
		AssertClick(
			locator1 = "MessageBoards#NAVIGATION_STATISTICS",
			value1 = "Statistics"
		);

		if (IsElementPresent(locator1 = "MessageBoardsStatistics#GENERAL_DROPDOWN_COLLAPSED")) {
			AssertClick(
				locator1 = "MessageBoardsStatistics#GENERAL_DROPDOWN",
				value1 = "General"
			);
		}

		AssertTextEquals(
			locator1 = "MessageBoardsStatistics#GENERAL_NUMBER_OF_POSTS",
			value1 = "${threadPostNumber}"
		);

		if (isSet(userPostNumber)) {
			MessageboardsThread.viewStatisticsTopPoster();
		}
		else {
			MessageboardsThread.viewStatisticsTopPoster(
				userMessageboardsRank = "${userMessageboardsRank}",
				userName = "${userName}",
				userPostNumber = "${threadPostNumber}"
			);
		}
	}

	macro viewStatisticsTopPoster {
		AssertClick(
			locator1 = "MessageBoards#NAVIGATION_STATISTICS",
			value1 = "Statistics"
		);

		if (IsElementPresent(locator1 = "MessageBoardsStatistics#TOP_POSTERS_DROPDOWN_COLLAPSED")) {
			AssertClick(
				locator1 = "MessageBoardsStatistics#TOP_POSTERS_DROPDOWN",
				value1 = "Top Posters"
			);
		}

		var key_userName = "${userName}";

		AssertTextEquals(
			locator1 = "MessageBoardsStatistics#TOP_POSTERS_AUTHOR_NAME",
			value1 = "${userName}"
		);

		if (isSet(userMessageboardsRank)) {
			AssertTextEquals(
				locator1 = "MessageBoardsStatistics#TOP_POSTERS_AUTHOR_RANK",
				value1 = "Rank: ${userMessageboardsRank}"
			);
		}
		else {
			AssertTextEquals(
				locator1 = "MessageBoardsStatistics#TOP_POSTERS_AUTHOR_RANK",
				value1 = "Rank: Youngling"
			);
		}

		AssertTextEquals(
			locator1 = "MessageBoardsStatistics#TOP_POSTERS_AUTHOR_POSTS",
			value1 = "Posts: ${userPostNumber}"
		);

		AssertElementPresent(
			locator1 = "MessageBoardsStatistics#TOP_POSTERS_AUTHOR_JOIN_DATE"
		);

		AssertElementPresent(
			locator1 = "MessageBoardsStatistics#TOP_POSTERS_AUTHOR_LAST_POST_DATE"
		);

		AssertElementPresent(
			locator1 = "MessageBoardsStatistics#TOP_POSTERS_AUTHOR_ICON"
		);
	}

	macro viewWithWorkflowPG {
		var key_threadBody = "threadBody";
		var key_threadSubject = "${threadSubject}";
		var key_userName = "${userName}";

		AssertElementPresent(locator1 = "MessageBoards#THREAD_TABLE_POSTS");

		AssertElementPresent(locator1 = "MessageBoards#THREAD_LIST_LAST_POST");

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		var key_threadStatus = "Pending (${workflowTask})";

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_STATUS",
			value1 = "Pending (${workflowTask})"
		);

		AssertClick(locator1 = "MessageBoards#NAVIGATION_MY_POSTS", value1 = "My Posts");

		AssertTextEquals(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#MESSAGE_WORKFLOW_STATUS_1",
			value1 = "Pending (${workflowTask})"
		);

		AssertClick(
			locator1 = "MessageBoards#THREAD_LIST_THREAD",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "Portlet#H3_HEADER_TITLE",
			value1 = "${threadSubject}"
		);

		AssertTextEquals.assertPartialText(
			locator1 = "MessageBoardsThread#THREAD_USERNAME",
			value1 = "${userName}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_SUBJECT",
			value1 = "${threadSubject}"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#MESSAGE_WORKFLOW_STATUS_1",
			value1 = "Pending"
		);

		AssertTextEquals(
			locator1 = "MessageBoardsThread#THREAD_BODY",
			value1 = "${threadBody}",
			key_threadBody = "${threadBody}"
		);
	}

	macro viewWithWorkflowPGViaAP {
		AssertElementNotPresent(
			locator1 = "AP#ASSET_ABSTRACT_TITLE",
			key_assetTitle = "${threadSubject}"
		);
	}
}